%%
%start
clear
clc
load noise.mat
L=128;
alpha=0.5;
fs=1;
F0=fs/L;
N0=1024;
T=1/fs;
A1=2;
A2=2;
f1=0.32;
f2=0.35;
fs=1;
t=0:1:N0-1;
%%
%calculate
S = calcwelch(L,alpha);
w=hanning(L,'periodic');
x=A1*cos(2*pi*f1*t)+A2*cos(2*pi*f2*t)+noise(t+1);
S1=pwelch(x,w,25,L);
S2=pwelch(x,w,90,L);
%%
%pic1
figure(1);
subplot(2,1,1)
plot((0:1:L*0.5-1)*F0,S1(1:1:0.5*L),'b')
xlabel('f/Hz')
title('hanning窗，L=128,重叠率25%')
ylabel('功率谱');
subplot(2,1,2)
plot((0:1:L*0.5-1)*F0,S2(1:1:0.5*L))
xlabel('f/Hz')
title('hanning窗，L=128,重叠率90%')
ylabel('功率谱');

%%
%start2
clear
clc
load noise.mat
K=7;
alpha=[0.25,0.9];
N0=1024;
fs=1;
A1=2;
A2=2;
f1=0.32;
f2=0.35;
fs=1;
t=0:1:N0-1;
%%
%calculate2
L1=floor(N0/(1+(K-1)*(1-alpha(1))));
L2=N0/(1+(K-1)*(1-alpha(2)));
w1=hanning(L1,'periodic');
w2=hanning(L2,'periodic');
x=A1*cos(2*pi*f1*t)+A2*cos(2*pi*f2*t)+noise(t+1);
S1=pwelch(x,w1,25,L1);
S2=pwelch(x,w2,90,L2);
%%
%pic2
figure(2);
subplot(2,1,1)
plot((0:1:L1*0.5-1)*fs/L1,S1(1:1:0.5*L1),'b')
xlabel('f/Hz')
ylabel('功率谱');
title('hanning窗，K=7,重叠率25%')
subplot(2,1,2)
plot((0:1:L2*0.5-1)*fs/L2,S2(1:1:0.5*L2))
xlabel('f/Hz')
ylabel('功率谱');
title('hanning窗，K=7,重叠率90%')

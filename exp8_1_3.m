clear
clc
load noise.mat
%%
%start
A1=2;A2=2;f1=0.32;f2=0.35;fs=1;N=1024;T=1/fs;
noise=noise(1:1:N);
N2=128;N3=256;
%%
%sample
t2=0:1:N2-1;
t3=0:1:N3-1;
x2=A1*cos(2*pi*f1*t2)+A2*cos(2*pi*f2*t2)+noise(t2+1);
x3=A1*cos(2*pi*f1*t3)+A2*cos(2*pi*f2*t3)+noise(t3+1);
%%
%window
w1=bartlett(N2);
w2=hanning(N2);
w3=bartlett(N3);
w4=hanning(N3);
%%
%energy
U1=sum(w1.^2);
U2=sum(w2.^2);
U3=sum(w3.^2);
U4=sum(w4.^2);
%%
%calculate
S20=abs(fft(x2)).^2/N2;
S21=abs(fft(x2.*bartlett(N2)')).^2/N2/U1;
S22=abs(fft(x2.*hanning(N2)')).^2/N2/U2;
S30=abs(fft(x3)).^2/N3;
S31=abs(fft(x3.*bartlett(N3)')).^2/N3/U3;
S32=abs(fft(x3.*hanning(N3)')).^2/N3/U4;
%%
%pic
subplot(2,3,1)
plot(t2(1:0.5*N2)/N2,S20(1:0.5*N2),'b')
title('N=128,矩形窗')
xlabel('f/Hz');ylabel('功率谱');
subplot(2,3,2)
plot(t2(1:0.5*N2)/N2,S21(1:0.5*N2),'r')
title('N=128,bartlett窗')
xlabel('f/Hz');ylabel('功率谱');
subplot(2,3,3)
plot(t2(1:0.5*N2)/N2,S22(1:0.5*N2))
title('N=128，hanning窗')
xlabel('f/Hz');ylabel('功率谱');
subplot(2,3,4)
plot(t3(1:0.5*N3)/N3,S30(1:0.5*N3),'b')
title('N=256,矩形窗')
xlabel('f/Hz');ylabel('功率谱');
subplot(2,3,5)
plot(t3(1:0.5*N3)/N3,S31(1:0.5*N3),'r')
title('N=256，bartlett窗')
xlabel('f/Hz');ylabel('功率谱');
subplot(2,3,6)
plot(t3(1:0.5*N3)/N3,S32(1:0.5*N3))
title('N=256，hanning窗')
xlabel('f/Hz');ylabel('功率谱');
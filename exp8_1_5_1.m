%%
%start
clc
clear
load noise.mat
alpha=0.5;
L=128;
fs=1;
F0=fs/L;
N0=1024;
T=1/fs;
A1=2;
A2=2;
f1=0.32;
f2=0.35;
fs=1;
t=0:1:N0-1;
K=(N0-L)/((1-alpha)*L)+1;
%%
%calculate
s=calcbartlett(128,1024);
w=hanning(L,'periodic');
x=A1*cos(2*pi*f1*t)+A2*cos(2*pi*f2*t)+noise(t+1);
s1=pwelch(x,w,50,L);
%%
%pic
subplot(2,1,1);
plot((0:1:L*0.5-1)*F0,s(1:1:0.5*L),'b');
xlabel('f/Hz');
ylabel('功率谱');
title('N=128,自己编写的函数，bartlett')
subplot(2,1,2);
plot((0:1:L*0.5-1)*F0,s1(1:1:0.5*L));
xlabel('f/Hz');
ylabel('功率谱');
title('hanning窗，pwelch函数，K=7,重叠率50%')